// TODO: Add mailing list options
// https://apidocs.mailchimp.com/api/2.0/lists/subscribe.php
// http://stackoverflow.com/questions/19671676/javascript-mailchimp-api-subscribe

Percolate = typeof Percolate === 'undefined' ? {} : Percolate;
Percolate.Contact = {};

Percolate.Contact.Overlay = React.createClass({displayName: "Overlay",
  propTypes: {
    open: React.PropTypes.bool
  },
  
  getDefaultProps: function() {
    return {
      open: false
    }
  },
  
  getInitialState: function() {
    return {
      open: this.props.open
    }
  },
  
  componentWillReceiveProps: function(nextProps) {
    if (nextProps.open)
      this.setOpen(nextProps.open);
  },
  
  setOpen: function(open) {
    this.setState({open: !! open});
  },
  
  handleClose: function(event) {
    event.preventDefault();
    this.setOpen(false);
  },
  
  render: function() {
    var classes = React.addons.classSet({
      'layout': true,
      'contact-open': this.state.open
    });

    return (
      React.createElement("div", {className: classes}, 
        React.createElement("div", {className: "overlay-screen-contact"}, 
          React.createElement("a", {className: "overlay-close", onClick: this.handleClose}, 
            React.createElement("span", {className: "icon-cross"})
          ), 
          React.createElement(Percolate.Contact.Form, {setOverlayOpen: this.setOpen}), 
          React.createElement(Percolate.Contact.Footer, null)
        )
      )
    )
  }
});

Percolate.Contact.Footer = React.createClass({displayName: "Footer",
  render: function() {
    return (
      React.createElement("div", {className: "ancillary-contact vcard"}, 
        React.createElement("div", {className: "wrapper-connect"}, 
          React.createElement("div", {className: "title-ancillary"}, "Connect"), 
          React.createElement("div", {className: "list"}, 
            React.createElement("a", {className: "url monochrome", href: "http://twitter.com/percolatestudio", target: "_blank"}, "Twitter"), 
            React.createElement("a", {className: "url monochrome", href: "http://github.com/percolatestudio", target: "_blank"}, "Github"), 
            React.createElement("a", {className: "email monochrome", href: "mailto:us@percolatestudio.com?subject=Hello%20Percolate"}, "Email")
          )
        ), 
        React.createElement("div", {className: "wrapper-visit"}, 
          React.createElement("div", {className: "title-ancillary"}, "Visit Us"), 
          React.createElement("a", {className: "location-wrapper organization-unit adr", 
            href: "https://www.google.com/maps/place/169+11th+St,+San+Francisco,+CA+94103/@37.77357,-122.415787,17z/data=!3m1!4b1!4m2!3m1!1s0x8085809d83ced185:0xf5e9ad23d5cd5ce5", target: "_blank"}, 
            React.createElement("span", {className: "fn organization-name", style:  {display: 'none'} }, "Percolate Studio"), 
            React.createElement("span", null, "Percolate USA"), React.createElement("br", null), 
            React.createElement("span", {className: "street-address"}, "169 11th Street"), React.createElement("br", null), 
            React.createElement("span", {className: "locality"}, "San Francisco"), ", ", React.createElement("span", {className: "region"}, "CA"), " ", React.createElement("span", {className: "postal-code"}, "94103")
          ), 
          React.createElement("a", {className: "location-wrapper organization-unit adr", 
            href: "https://www.google.com/maps/place/50+Herbert+St,+Northcote+VIC+3070,+Australia/@-37.771764,144.995165,17z/data=!3m1!4b1!4m2!3m1!1s0x6ad6437ca420f13f:0xb6908ada5cdfa379", target: "_blank"}, 
            React.createElement("span", null, "Percolate AUS"), React.createElement("br", null), 
            React.createElement("span", {className: "street-address"}, "50 Herbert Street"), React.createElement("br", null), 
            React.createElement("span", {className: "locality"}, "Melbourne"), ", ", React.createElement("span", {className: "region"}, "VIC"), " ", React.createElement("span", {className: "postal-code"}, "3001")
          )
        )
      )
    )
  }
});

// Gathers all truthy values in obj referenced by keys and returns matching
// keys in an array
var gatherTruthy = function(/* obj, ...keys */) {
  var keys = Array.prototype.slice.call(arguments);
  var result = [];
  
  obj = keys.shift();
  
  _.each(keys, function(key) {
    if (obj[key] && result.indexOf(key) === -1)
      result.push(key);
  });
  
  return result;
}

Percolate.Contact.Form = React.createClass({displayName: "Form",
  mixins: [React.addons.LinkedStateMixin],
  
  getInitialState: function() {
    return {
      name: '',
      email: '',
      about: '',
      strategy: false,
      design: false,
      engineering: false,
      consulting: false,
      today: false,
      quarter: false,
      year: false,
      '25k': false,
      '50k': false,
      '100k': false,
      notsure: false,
      errors: {},
      submitting: false
    };
  },
  
  getModel: function() {
    var model = _.pick(this.state, 'name', 'email', 'about');
    model.services = gatherTruthy(this.state, 'strategy', 'design', 
      'engineering', 'consulting');
    model.timing = gatherTruthy(this.state, 'today', 'quarter', 'year');
    model.budget = gatherTruthy(this.state, '25k', '50k', '100k', 'notsure');

    return model;
  },
    
  handleSubmit: function(event) {
    event.preventDefault();
    
    if (this.validate()) {
      this.send();
    }
  },
  
  componentDidMount: function() {
    jQuery(this.refs.about.getDOMNode()).autosize();
  },
  
  alertClass: function(name) {
    return this.state.errors[name] ? 'alert' : '';
  },
  
  // urgh, wish we had a schema library
  validate: function() {
    var errors = this.state.errors = {}, 
      valid = true,
      model = this.getModel();
    
    _.each(['name', 'email', 'about'], function(field) {
      if (! model[field]) {
        errors[field] = 'is required';
        valid = false;
      } else if (model[field].length > 10000) {
        errors[field] = 'is too long';
        valid = false;
      }
    }.bind(this));
    
    _.each(['services', 'timing'], function(field) {
      if (! model[field].length) {
        errors[field] = 'is required';
        valid = false;
      }
    }.bind(this));

    if (this.shouldHaveBudget() && ! model.budget.length) {
      errors['budget'] = 'is required';
      valid = false;
    }
    
    this.setState({errors: errors});

    return valid;
  },
  
  send: function(model) {
    var model = this.getModel();
    var to = 'us@percolatestudio.com';
    var subject = 'Work with us';
    var body = React.renderToStaticMarkup(
      React.createElement(Percolate.Contact.FormEmail, {model: model}));
  
    var data = {
        'key': '-JqlbKb2ZHU7R5NEkCvnKw', // changeme
        'message': {
          'from_email': model.email,
          'to': [
              {
                'email': to,
                'name': 'Percolate Studio',
                'type': 'to'
              },
              {
                'email': 'zol@percolatestudio.com', // just in case us@ breaks
                'name': 'Zoltan Olah',
                'type': 'to'
              }
            ],
          'autotext': 'true',
          'subject': subject,
          'html': body
        }
      };
  
    this.setState({ submitting: true });
    jQuery.post('https://mandrillapp.com/api/1.0/messages/send.json', data)
      .done(function() {
        alert('Thank you. We will contact you shortly');
      })
      .fail(function() {
        // fallback incase ajax fails
        window.open('mailto:' + to 
          + '?subject=' + subject + ' (mailto)'
          + '&body=' + escape(body)
        );
      })
      .always(function() {
        this.setState({ submitting: false });
        this.props.setOverlayOpen(false);
      }.bind(this));
  },
  
  error: function(name) {
    if (this.state.errors[name])
      return (React.createElement("span", {className: "error"}, this.state.errors[name]));
  },
  
  shouldHaveBudget: function() {
    return this.state.strategy || this.state.design || this.state.engineering;
  },

  render: function() {
    var budgetFieldsetClasses = "fieldset-group "
      + (this.shouldHaveBudget() ? 'visible' : 'hidden');
    
    var servicesError = this.error('services');

    var servicesLabel = servicesError ? servicesError :
      (React.createElement("span", {className: "subtext"}, "Select all that apply"));

    return (
      React.createElement("form", {className: "contact-form-wrapper", onSubmit: this.handleSubmit}, 
        React.createElement("div", {className: "title-overlay"}, "Work with us"), 
        React.createElement("fieldset", null, 
          React.createElement("div", {className: "input-symbol left"}, 
            React.createElement("input", {type: "text", name: "name", className: this.alertClass('name'), placeholder: "Name", valueLink: this.linkState('name')}), 
            React.createElement("span", {className: "icon-user"})
          ), 
          React.createElement("div", {className: "input-symbol left"}, 
            React.createElement("input", {type: "email", name: "email", className: this.alertClass('email'), placeholder: "Email Address", valueLink: this.linkState('email')}), 
            React.createElement("span", {className: "icon-email"})
          ), 
          React.createElement("textarea", {className: 'about ' + this.alertClass('about'), name: "about", placeholder: "About your company and project", valueLink: this.linkState('about'), ref: "about"}), 
          React.createElement("div", {className: "fieldset-group services"}, 
            React.createElement("div", {className: "fieldset-group-title"}, "Services ", servicesLabel), 

            React.createElement("div", {className: "btns-group"}, 
              React.createElement("input", {type: "checkbox", name: "services", value: "strategy", id: "strategy", checkedLink: this.linkState('strategy')}), 
              React.createElement("label", {htmlFor: "strategy", className: "btn-toggle"}, "Strategy"), 

              React.createElement("input", {type: "checkbox", name: "services", value: "design", id: "design", checkedLink: this.linkState('design')}), 
              React.createElement("label", {htmlFor: "design", className: "btn-toggle"}, "Design"), 

              React.createElement("input", {type: "checkbox", name: "services", value: "engineering", id: "engineering", checkedLink: this.linkState('engineering')}), 
              React.createElement("label", {htmlFor: "engineering", className: "btn-toggle"}, "Engineering"), 

              React.createElement("input", {type: "checkbox", name: "services", value: "consulting", id: "consulting", checkedLink: this.linkState('consulting')}), 
              React.createElement("label", {htmlFor: "consulting", className: "btn-toggle"}, "Consulting")
            )
          ), 
          React.createElement("div", {className: "fieldset-group"}, 
            React.createElement("div", {className: "fieldset-group-title"}, "Timing ", this.error('timing')), 

            React.createElement("div", {className: "btns-group"}, 
              React.createElement("input", {type: "radio", name: "timing", value: "today", id: "today", checkedLink: this.linkState('today')}), 
              React.createElement("label", {htmlFor: "today", className: "btn-toggle"}, "Today"), 

              React.createElement("input", {type: "radio", name: "timing", value: "quarter", id: "quarter", checkedLink: this.linkState('quarter')}), 
              React.createElement("label", {htmlFor: "quarter", className: "btn-toggle"}, "Quarter"), 

              React.createElement("input", {type: "radio", name: "timing", value: "year", id: "year", checkedLink: this.linkState('year')}), 
              React.createElement("label", {htmlFor: "year", className: "btn-toggle"}, "This Year")
            )
          ), 
          React.createElement("div", {className: budgetFieldsetClasses}, 
            React.createElement("div", {className: "fieldset-group-title"}, "Budget ", this.error('budget')), 

            React.createElement("div", {className: "btns-group"}, 
              React.createElement("input", {type: "radio", name: "budget", value: "25k", id: "25k", checkedLink: this.linkState('25k')}), 
              React.createElement("label", {htmlFor: "25k", className: "btn-toggle"}, "25k–50k"), 

              React.createElement("input", {type: "radio", name: "budget", value: "50k", id: "50k", checkedLink: this.linkState('50k')}), 
              React.createElement("label", {htmlFor: "50k", className: "btn-toggle"}, "50k–100k"), 

              React.createElement("input", {type: "radio", name: "budget", value: "100k", id: "100k", checkedLink: this.linkState('100k')}), 
              React.createElement("label", {htmlFor: "100k", className: "btn-toggle"}, "+100k"), 

              React.createElement("input", {type: "radio", name: "budget", value: "notsure", id: "notsure", checkedLink: this.linkState('notsure')}), 
              React.createElement("label", {htmlFor: "notsure", className: "btn-toggle"}, "Not sure")
            )

          ), 
          React.createElement("button", {className: "btn-primary caps", disabled: this.state.submitting, type: "submit"}, "Send Message")
        )
      )
    )
  }
});

Percolate.Contact.FormEmail = React.createClass({displayName: "FormEmail",
  render: function() {
    var model = this.props.model;
    
    var servicesNodes = model.services.map(function(service, index) {
      return ( React.createElement("li", {key: index}, service) );
    });
    
    var timing = model.timing.join();
    var budget = model.budget.join();
    
    var budgetNodes = budget ? [React.createElement("dt", {key: "0"}, "Budget"), React.createElement("dd", {key: "1"}, budget)] : null;
    
    return (
      React.createElement("dl", null, 
        React.createElement("dt", null, "Name"), React.createElement("dd", null, model.name), 
        React.createElement("dt", null, "Email"), React.createElement("dd", null, model.email), 
        React.createElement("dt", null, "About"), React.createElement("dd", null, model.about), 
        React.createElement("dt", null, "Services"), React.createElement("dd", null, React.createElement("ul", null, servicesNodes)), 
        React.createElement("dt", null, "Timing"), React.createElement("dd", null, timing), 
        budgetNodes, 
        React.createElement("dt", null, "Referer"), React.createElement("dd", null, "Blog")
      )
    )
  }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtZWQuanMiLCJzb3VyY2VzIjpbbnVsbF0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGlDQUFpQztBQUNqQyw0REFBNEQ7QUFDNUQsaUZBQWlGOztBQUVqRixTQUFTLEdBQUcsT0FBTyxTQUFTLEtBQUssV0FBVyxHQUFHLEVBQUUsR0FBRyxTQUFTLENBQUM7QUFDOUQsU0FBUyxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7O0FBRXZCLCtDQUErQyx1QkFBQTtFQUM3QyxTQUFTLEVBQUU7SUFDVCxJQUFJLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJO0FBQzlCLEdBQUc7O0VBRUQsZUFBZSxFQUFFLFdBQVcsQ0FBQztJQUMzQixPQUFPO01BQ0wsSUFBSSxFQUFFLEtBQUs7S0FDWjtBQUNMLEdBQUc7O0VBRUQsZUFBZSxFQUFFLFdBQVcsQ0FBQztJQUMzQixPQUFPO01BQ0wsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSTtLQUN0QjtBQUNMLEdBQUc7O0VBRUQseUJBQXlCLEVBQUUsU0FBUyxTQUFTLEVBQUUsQ0FBQztJQUM5QyxJQUFJLFNBQVMsQ0FBQyxJQUFJO01BQ2hCLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ25DLEdBQUc7O0VBRUQsT0FBTyxFQUFFLFNBQVMsSUFBSSxFQUFFLENBQUM7SUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUNuQyxHQUFHOztFQUVELFdBQVcsRUFBRSxTQUFTLEtBQUssRUFBRSxDQUFDO0lBQzVCLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN2QixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3hCLEdBQUc7O0VBRUQsTUFBTSxFQUFFLFdBQVcsQ0FBQztJQUNsQixJQUFJLE9BQU8sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQztNQUNsQyxRQUFRLEVBQUUsSUFBSTtNQUNkLGNBQWMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUk7QUFDckMsS0FBSyxDQUFDLENBQUM7O0lBRUg7TUFDRSxvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFFLE9BQVMsQ0FBQSxFQUFBO1FBQ3ZCLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsd0JBQXlCLENBQUEsRUFBQTtVQUN0QyxvQkFBQSxHQUFFLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGVBQUEsRUFBZSxDQUFDLE9BQUEsRUFBTyxDQUFFLElBQUksQ0FBQyxXQUFhLENBQUEsRUFBQTtZQUN0RCxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLFlBQWEsQ0FBTyxDQUFBO1VBQ2xDLENBQUEsRUFBQTtVQUNKLG9CQUFDLHNCQUFzQixFQUFBLENBQUEsQ0FBQyxjQUFBLEVBQWMsQ0FBRSxJQUFJLENBQUMsT0FBUSxDQUFBLENBQUcsQ0FBQSxFQUFBO1VBQ3hELG9CQUFDLHdCQUF3QixFQUFBLElBQUEsQ0FBRyxDQUFBO1FBQ3hCLENBQUE7TUFDRixDQUFBO0tBQ1A7R0FDRjtBQUNILENBQUMsQ0FBQyxDQUFDOztBQUVILDhDQUE4QyxzQkFBQTtFQUM1QyxNQUFNLEVBQUUsV0FBVyxDQUFDO0lBQ2xCO01BQ0Usb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyx5QkFBMEIsQ0FBQSxFQUFBO1FBQ3ZDLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsaUJBQWtCLENBQUEsRUFBQTtVQUMvQixvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGlCQUFrQixDQUFBLEVBQUEsU0FBYSxDQUFBLEVBQUE7VUFDOUMsb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxNQUFPLENBQUEsRUFBQTtZQUNwQixvQkFBQSxHQUFFLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGdCQUFBLEVBQWdCLENBQUMsSUFBQSxFQUFJLENBQUMsb0NBQUEsRUFBb0MsQ0FBQyxNQUFBLEVBQU0sQ0FBQyxRQUFTLENBQUEsRUFBQSxTQUFXLENBQUEsRUFBQTtZQUNuRyxvQkFBQSxHQUFFLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGdCQUFBLEVBQWdCLENBQUMsSUFBQSxFQUFJLENBQUMsbUNBQUEsRUFBbUMsQ0FBQyxNQUFBLEVBQU0sQ0FBQyxRQUFTLENBQUEsRUFBQSxRQUFVLENBQUEsRUFBQTtZQUNqRyxvQkFBQSxHQUFFLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGtCQUFBLEVBQWtCLENBQUMsSUFBQSxFQUFJLENBQUMseURBQTBELENBQUEsRUFBQSxPQUFTLENBQUE7VUFDcEcsQ0FBQTtRQUNGLENBQUEsRUFBQTtRQUNOLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsZUFBZ0IsQ0FBQSxFQUFBO1VBQzdCLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsaUJBQWtCLENBQUEsRUFBQSxVQUFjLENBQUEsRUFBQTtVQUMvQyxvQkFBQSxHQUFFLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLHdDQUFBLEVBQXdDO1lBQ25ELElBQUEsRUFBSSxDQUFDLGdLQUFBLEVBQWdLLENBQUMsTUFBQSxFQUFNLENBQUMsUUFBUyxDQUFBLEVBQUE7WUFDdEwsb0JBQUEsTUFBSyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxzQkFBQSxFQUFzQixDQUFDLEtBQUEsRUFBSyxDQUFFLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBSSxDQUFBLEVBQUEsa0JBQXVCLENBQUEsRUFBQTtZQUMxRixvQkFBQSxNQUFLLEVBQUEsSUFBQyxFQUFBLGVBQW9CLENBQUEsRUFBQSxvQkFBQSxJQUFHLEVBQUEsSUFBRSxDQUFBLEVBQUE7WUFDL0Isb0JBQUEsTUFBSyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxnQkFBaUIsQ0FBQSxFQUFBLGlCQUFzQixDQUFBLEVBQUEsb0JBQUEsSUFBRyxFQUFBLElBQUUsQ0FBQSxFQUFBO1lBQzVELG9CQUFBLE1BQUssRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsVUFBVyxDQUFBLEVBQUEsZUFBb0IsQ0FBQSxFQUFBLElBQUEsRUFBRSxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLFFBQVMsQ0FBQSxFQUFBLElBQVMsQ0FBQSxFQUFBLEdBQUEsRUFBQyxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGFBQWMsQ0FBQSxFQUFBLE9BQVksQ0FBQTtVQUM1SCxDQUFBLEVBQUE7VUFDSixvQkFBQSxHQUFFLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLHdDQUFBLEVBQXdDO1lBQ25ELElBQUEsRUFBSSxDQUFDLHlLQUFBLEVBQXlLLEVBQUUsTUFBQSxFQUFNLENBQUMsUUFBUyxDQUFBLEVBQUE7WUFDaE0sb0JBQUEsTUFBSyxFQUFBLElBQUMsRUFBQSxlQUFvQixDQUFBLEVBQUEsb0JBQUEsSUFBRyxFQUFBLElBQUUsQ0FBQSxFQUFBO1lBQy9CLG9CQUFBLE1BQUssRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsZ0JBQWlCLENBQUEsRUFBQSxtQkFBd0IsQ0FBQSxFQUFBLG9CQUFBLElBQUcsRUFBQSxJQUFFLENBQUEsRUFBQTtZQUM5RCxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLFVBQVcsQ0FBQSxFQUFBLFdBQWdCLENBQUEsRUFBQSxJQUFBLEVBQUUsb0JBQUEsTUFBSyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxRQUFTLENBQUEsRUFBQSxLQUFVLENBQUEsRUFBQSxHQUFBLEVBQUMsb0JBQUEsTUFBSyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxhQUFjLENBQUEsRUFBQSxNQUFXLENBQUE7VUFDeEgsQ0FBQTtRQUNBLENBQUE7TUFDRixDQUFBO0tBQ1A7R0FDRjtBQUNILENBQUMsQ0FBQyxDQUFDOztBQUVILDJFQUEyRTtBQUMzRSxtQkFBbUI7QUFDbkIsSUFBSSxZQUFZLEdBQUcsNkJBQTZCLENBQUM7RUFDL0MsSUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ25ELEVBQUUsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDOztBQUVsQixFQUFFLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7O0VBRW5CLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDMUIsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7TUFDeEMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN2QixHQUFHLENBQUMsQ0FBQzs7RUFFSCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDOztBQUVELDRDQUE0QyxvQkFBQTtBQUM1QyxFQUFFLE1BQU0sRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUM7O0VBRXZDLGVBQWUsRUFBRSxXQUFXLENBQUM7SUFDM0IsT0FBTztNQUNMLElBQUksRUFBRSxFQUFFO01BQ1IsS0FBSyxFQUFFLEVBQUU7TUFDVCxLQUFLLEVBQUUsRUFBRTtNQUNULFFBQVEsRUFBRSxLQUFLO01BQ2YsTUFBTSxFQUFFLEtBQUs7TUFDYixXQUFXLEVBQUUsS0FBSztNQUNsQixVQUFVLEVBQUUsS0FBSztNQUNqQixLQUFLLEVBQUUsS0FBSztNQUNaLE9BQU8sRUFBRSxLQUFLO01BQ2QsSUFBSSxFQUFFLEtBQUs7TUFDWCxLQUFLLEVBQUUsS0FBSztNQUNaLEtBQUssRUFBRSxLQUFLO01BQ1osTUFBTSxFQUFFLEtBQUs7TUFDYixPQUFPLEVBQUUsS0FBSztNQUNkLE1BQU0sRUFBRSxFQUFFO01BQ1YsVUFBVSxFQUFFLEtBQUs7S0FDbEIsQ0FBQztBQUNOLEdBQUc7O0VBRUQsUUFBUSxFQUFFLFdBQVcsQ0FBQztJQUNwQixJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN6RCxLQUFLLENBQUMsUUFBUSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFVBQVUsRUFBRSxRQUFRO01BQzVELGFBQWEsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUMvQixLQUFLLENBQUMsTUFBTSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDeEUsSUFBSSxLQUFLLENBQUMsTUFBTSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDOztJQUV6RSxPQUFPLEtBQUssQ0FBQztBQUNqQixHQUFHOztFQUVELFlBQVksRUFBRSxTQUFTLEtBQUssRUFBRSxDQUFDO0FBQ2pDLElBQUksS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDOztJQUV2QixJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRTtNQUNuQixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDYjtBQUNMLEdBQUc7O0VBRUQsaUJBQWlCLEVBQUUsV0FBVyxDQUFDO0lBQzdCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQ3BELEdBQUc7O0VBRUQsVUFBVSxFQUFFLFNBQVMsSUFBSSxFQUFFLENBQUM7SUFDMUIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQ2xELEdBQUc7QUFDSDs7RUFFRSxRQUFRLEVBQUUsV0FBVyxDQUFDO0lBQ3BCLElBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLEVBQUU7TUFDakMsS0FBSyxHQUFHLElBQUk7QUFDbEIsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDOztJQUUxQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRSxTQUFTLEtBQUssRUFBRSxDQUFDO01BQ2xELElBQUksRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDbEIsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLGFBQWEsQ0FBQztRQUM5QixLQUFLLEdBQUcsS0FBSyxDQUFDO09BQ2YsTUFBTSxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLEdBQUcsS0FBSyxFQUFFO1FBQ3RDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxhQUFhLENBQUM7UUFDOUIsS0FBSyxHQUFHLEtBQUssQ0FBQztPQUNmO0FBQ1AsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDOztJQUVkLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLEVBQUUsU0FBUyxLQUFLLEVBQUUsQ0FBQztNQUM5QyxJQUFJLEVBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRTtRQUN6QixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsYUFBYSxDQUFDO1FBQzlCLEtBQUssR0FBRyxLQUFLLENBQUM7T0FDZjtBQUNQLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzs7SUFFZCxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUU7TUFDcEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLGFBQWEsQ0FBQztNQUNqQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0FBQ3BCLEtBQUs7O0FBRUwsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7O0lBRWhDLE9BQU8sS0FBSyxDQUFDO0FBQ2pCLEdBQUc7O0VBRUQsSUFBSSxFQUFFLFNBQVMsS0FBSyxFQUFFLENBQUM7SUFDckIsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzVCLElBQUksRUFBRSxHQUFHLHdCQUF3QixDQUFDO0lBQ2xDLElBQUksT0FBTyxHQUFHLGNBQWMsQ0FBQztJQUM3QixJQUFJLElBQUksR0FBRyxLQUFLLENBQUMsb0JBQW9CO0FBQ3pDLE1BQU0sb0JBQUMsMkJBQTJCLEVBQUEsQ0FBQSxDQUFDLEtBQUEsRUFBSyxDQUFFLEtBQU0sQ0FBRSxDQUFBLENBQUMsQ0FBQzs7SUFFaEQsSUFBSSxJQUFJLEdBQUc7UUFDUCxLQUFLLEVBQUUsd0JBQXdCO1FBQy9CLFNBQVMsRUFBRTtVQUNULFlBQVksRUFBRSxLQUFLLENBQUMsS0FBSztVQUN6QixJQUFJLEVBQUU7Y0FDRjtnQkFDRSxPQUFPLEVBQUUsRUFBRTtnQkFDWCxNQUFNLEVBQUUsa0JBQWtCO2dCQUMxQixNQUFNLEVBQUUsSUFBSTtlQUNiO2NBQ0Q7Z0JBQ0UsT0FBTyxFQUFFLHlCQUF5QjtnQkFDbEMsTUFBTSxFQUFFLGFBQWE7Z0JBQ3JCLE1BQU0sRUFBRSxJQUFJO2VBQ2I7YUFDRjtVQUNILFVBQVUsRUFBRSxNQUFNO1VBQ2xCLFNBQVMsRUFBRSxPQUFPO1VBQ2xCLE1BQU0sRUFBRSxJQUFJO1NBQ2I7QUFDVCxPQUFPLENBQUM7O0lBRUosSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0RBQW9ELEVBQUUsSUFBSSxDQUFDO09BQ3BFLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDaEIsS0FBSyxDQUFDLHdDQUF3QyxDQUFDLENBQUM7T0FDakQsQ0FBQztBQUNSLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQzs7UUFFaEIsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRTtZQUN0QixXQUFXLEdBQUcsT0FBTyxHQUFHLFdBQVc7WUFDbkMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7U0FDMUIsQ0FBQztPQUNILENBQUM7T0FDRCxNQUFNLENBQUMsV0FBVyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUNyQyxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztPQUNsQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ3BCLEdBQUc7O0VBRUQsS0FBSyxFQUFFLFNBQVMsSUFBSSxFQUFFLENBQUM7SUFDckIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7TUFDekIsUUFBUSxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLE9BQVEsQ0FBQSxFQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBUyxDQUFBLEVBQUU7QUFDeEUsR0FBRzs7RUFFRCxnQkFBZ0IsRUFBRSxXQUFXLENBQUM7SUFDNUIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQztBQUM5RSxHQUFHOztFQUVELE1BQU0sRUFBRSxXQUFXLENBQUM7SUFDbEIsSUFBSSxxQkFBcUIsR0FBRyxpQkFBaUI7QUFDakQsU0FBUyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxTQUFTLEdBQUcsUUFBUSxDQUFDLENBQUM7O0FBRXpELElBQUksSUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQzs7SUFFM0MsSUFBSSxhQUFhLEdBQUcsYUFBYSxHQUFHLGFBQWE7QUFDckQsT0FBTyxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLFNBQVUsQ0FBQSxFQUFBLHVCQUE0QixDQUFBLENBQUMsQ0FBQzs7SUFFM0Q7TUFDRSxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLHNCQUFBLEVBQXNCLENBQUMsUUFBQSxFQUFRLENBQUUsSUFBSSxDQUFDLFlBQWMsQ0FBQSxFQUFBO1FBQ2xFLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsZUFBZ0IsQ0FBQSxFQUFBLGNBQWtCLENBQUEsRUFBQTtRQUNqRCxvQkFBQSxVQUFTLEVBQUEsSUFBQyxFQUFBO1VBQ1Isb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxtQkFBb0IsQ0FBQSxFQUFBO1lBQ2pDLG9CQUFBLE9BQU0sRUFBQSxDQUFBLENBQUMsSUFBQSxFQUFJLENBQUMsTUFBQSxFQUFNLENBQUMsSUFBQSxFQUFJLENBQUMsTUFBQSxFQUFNLENBQUMsU0FBQSxFQUFTLENBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBQyxDQUFDLFdBQUEsRUFBVyxDQUFDLE1BQUEsRUFBTSxDQUFDLFNBQUEsRUFBUyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7WUFDM0gsb0JBQUEsTUFBSyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxXQUFZLENBQU8sQ0FBQTtVQUMvQixDQUFBLEVBQUE7VUFDTixvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLG1CQUFvQixDQUFBLEVBQUE7WUFDakMsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxJQUFBLEVBQUksQ0FBQyxPQUFBLEVBQU8sQ0FBQyxJQUFBLEVBQUksQ0FBQyxPQUFBLEVBQU8sQ0FBQyxTQUFBLEVBQVMsQ0FBRSxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFDLENBQUMsV0FBQSxFQUFXLENBQUMsZUFBQSxFQUFlLENBQUMsU0FBQSxFQUFTLENBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUUsQ0FBQSxDQUFHLENBQUEsRUFBQTtZQUN4SSxvQkFBQSxNQUFLLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLFlBQWEsQ0FBTyxDQUFBO1VBQ2hDLENBQUEsRUFBQTtVQUNOLG9CQUFBLFVBQVMsRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUUsUUFBUSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQyxJQUFBLEVBQUksQ0FBQyxPQUFBLEVBQU8sQ0FBQyxXQUFBLEVBQVcsQ0FBQyxnQ0FBQSxFQUFnQyxDQUFDLFNBQUEsRUFBUyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQyxHQUFBLEVBQUcsQ0FBQyxPQUFPLENBQUEsQ0FBRyxDQUFBLEVBQUE7VUFDdEssb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyx5QkFBMEIsQ0FBQSxFQUFBO0FBQ25ELFlBQVksb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxzQkFBdUIsQ0FBQSxFQUFBLFdBQUEsRUFBVSxhQUFvQixDQUFBLEVBQUE7O1lBRXBFLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsWUFBYSxDQUFBLEVBQUE7Y0FDMUIsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxJQUFBLEVBQUksQ0FBQyxVQUFBLEVBQVUsQ0FBQyxJQUFBLEVBQUksQ0FBQyxVQUFBLEVBQVUsQ0FBQyxLQUFBLEVBQUssQ0FBQyxVQUFBLEVBQVUsQ0FBQyxFQUFBLEVBQUUsQ0FBQyxVQUFBLEVBQVUsQ0FBQyxXQUFBLEVBQVcsQ0FBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBRSxDQUFBLENBQUcsQ0FBQSxFQUFBO0FBQy9ILGNBQWMsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxPQUFBLEVBQU8sQ0FBQyxVQUFBLEVBQVUsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxZQUFhLENBQUEsRUFBQSxVQUFnQixDQUFBLEVBQUE7O2NBRWpFLG9CQUFBLE9BQU0sRUFBQSxDQUFBLENBQUMsSUFBQSxFQUFJLENBQUMsVUFBQSxFQUFVLENBQUMsSUFBQSxFQUFJLENBQUMsVUFBQSxFQUFVLENBQUMsS0FBQSxFQUFLLENBQUMsUUFBQSxFQUFRLENBQUMsRUFBQSxFQUFFLENBQUMsUUFBQSxFQUFRLENBQUMsV0FBQSxFQUFXLENBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUUsQ0FBQSxDQUFHLENBQUEsRUFBQTtBQUN6SCxjQUFjLG9CQUFBLE9BQU0sRUFBQSxDQUFBLENBQUMsT0FBQSxFQUFPLENBQUMsUUFBQSxFQUFRLENBQUMsU0FBQSxFQUFTLENBQUMsWUFBYSxDQUFBLEVBQUEsUUFBYyxDQUFBLEVBQUE7O2NBRTdELG9CQUFBLE9BQU0sRUFBQSxDQUFBLENBQUMsSUFBQSxFQUFJLENBQUMsVUFBQSxFQUFVLENBQUMsSUFBQSxFQUFJLENBQUMsVUFBQSxFQUFVLENBQUMsS0FBQSxFQUFLLENBQUMsYUFBQSxFQUFhLENBQUMsRUFBQSxFQUFFLENBQUMsYUFBQSxFQUFhLENBQUMsV0FBQSxFQUFXLENBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUUsQ0FBQSxDQUFHLENBQUEsRUFBQTtBQUN4SSxjQUFjLG9CQUFBLE9BQU0sRUFBQSxDQUFBLENBQUMsT0FBQSxFQUFPLENBQUMsYUFBQSxFQUFhLENBQUMsU0FBQSxFQUFTLENBQUMsWUFBYSxDQUFBLEVBQUEsYUFBbUIsQ0FBQSxFQUFBOztjQUV2RSxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLFVBQUEsRUFBVSxDQUFDLElBQUEsRUFBSSxDQUFDLFVBQUEsRUFBVSxDQUFDLEtBQUEsRUFBSyxDQUFDLFlBQUEsRUFBWSxDQUFDLEVBQUEsRUFBRSxDQUFDLFlBQUEsRUFBWSxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7Y0FDdkgsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxPQUFBLEVBQU8sQ0FBQyxZQUFBLEVBQVksQ0FBQyxTQUFBLEVBQVMsQ0FBQyxZQUFhLENBQUEsRUFBQSxZQUFrQixDQUFBO1lBQ2pFLENBQUE7VUFDRixDQUFBLEVBQUE7VUFDTixvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGdCQUFpQixDQUFBLEVBQUE7QUFDMUMsWUFBWSxvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLHNCQUF1QixDQUFBLEVBQUEsU0FBQSxFQUFRLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFRLENBQUEsRUFBQTs7WUFFekUsb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxZQUFhLENBQUEsRUFBQTtjQUMxQixvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQUEsRUFBTyxDQUFDLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUSxDQUFDLEtBQUEsRUFBSyxDQUFDLE9BQUEsRUFBTyxDQUFDLEVBQUEsRUFBRSxDQUFDLE9BQUEsRUFBTyxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7QUFDakgsY0FBYyxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLE9BQUEsRUFBTyxDQUFDLE9BQUEsRUFBTyxDQUFDLFNBQUEsRUFBUyxDQUFDLFlBQWEsQ0FBQSxFQUFBLE9BQWEsQ0FBQSxFQUFBOztjQUUzRCxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQUEsRUFBTyxDQUFDLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUSxDQUFDLEtBQUEsRUFBSyxDQUFDLFNBQUEsRUFBUyxDQUFDLEVBQUEsRUFBRSxDQUFDLFNBQUEsRUFBUyxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7QUFDdkgsY0FBYyxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLE9BQUEsRUFBTyxDQUFDLFNBQUEsRUFBUyxDQUFDLFNBQUEsRUFBUyxDQUFDLFlBQWEsQ0FBQSxFQUFBLFNBQWUsQ0FBQSxFQUFBOztjQUUvRCxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQUEsRUFBTyxDQUFDLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUSxDQUFDLEtBQUEsRUFBSyxDQUFDLE1BQUEsRUFBTSxDQUFDLEVBQUEsRUFBRSxDQUFDLE1BQUEsRUFBTSxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7Y0FDaEcsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxPQUFBLEVBQU8sQ0FBQyxNQUFBLEVBQU0sQ0FBQyxTQUFBLEVBQVMsQ0FBQyxZQUFhLENBQUEsRUFBQSxXQUFpQixDQUFBO1lBQzFELENBQUE7VUFDRixDQUFBLEVBQUE7VUFDTixvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFFLHFCQUF1QixDQUFBLEVBQUE7QUFDakQsWUFBWSxvQkFBQSxLQUFJLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLHNCQUF1QixDQUFBLEVBQUEsU0FBQSxFQUFRLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFRLENBQUEsRUFBQTs7WUFFekUsb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxZQUFhLENBQUEsRUFBQTtjQUMxQixvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQUEsRUFBTyxDQUFDLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUSxDQUFDLEtBQUEsRUFBSyxDQUFDLEtBQUEsRUFBSyxDQUFDLEVBQUEsRUFBRSxDQUFDLEtBQUEsRUFBSyxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7QUFDM0csY0FBYyxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLE9BQUEsRUFBTyxDQUFDLEtBQUEsRUFBSyxDQUFDLFNBQUEsRUFBUyxDQUFDLFlBQWEsQ0FBQSxFQUFBLFNBQWUsQ0FBQSxFQUFBOztjQUUzRCxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQUEsRUFBTyxDQUFDLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUSxDQUFDLEtBQUEsRUFBSyxDQUFDLEtBQUEsRUFBSyxDQUFDLEVBQUEsRUFBRSxDQUFDLEtBQUEsRUFBSyxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7QUFDM0csY0FBYyxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLE9BQUEsRUFBTyxDQUFDLEtBQUEsRUFBSyxFQUFFLFNBQUEsRUFBUyxDQUFDLFlBQWEsQ0FBQSxFQUFBLFVBQWdCLENBQUEsRUFBQTs7Y0FFN0Qsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxJQUFBLEVBQUksQ0FBQyxPQUFBLEVBQU8sQ0FBQyxJQUFBLEVBQUksQ0FBQyxRQUFBLEVBQVEsQ0FBQyxLQUFBLEVBQUssQ0FBQyxNQUFBLEVBQU0sQ0FBQyxFQUFBLEVBQUUsQ0FBQyxNQUFBLEVBQU0sQ0FBQyxXQUFBLEVBQVcsQ0FBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBRSxDQUFBLENBQUcsQ0FBQSxFQUFBO0FBQzlHLGNBQWMsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxPQUFBLEVBQU8sQ0FBQyxNQUFBLEVBQU0sQ0FBQyxTQUFBLEVBQVMsQ0FBQyxZQUFZLENBQUUsQ0FBQSxFQUFBLE9BQWEsQ0FBQSxFQUFBOztjQUUzRCxvQkFBQSxPQUFNLEVBQUEsQ0FBQSxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQUEsRUFBTyxDQUFDLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUSxDQUFDLEtBQUEsRUFBSyxDQUFDLFNBQUEsRUFBUyxDQUFDLEVBQUEsRUFBRSxDQUFDLFNBQUEsRUFBUyxDQUFDLFdBQUEsRUFBVyxDQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFFLENBQUEsQ0FBRyxDQUFBLEVBQUE7Y0FDekcsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxPQUFBLEVBQU8sQ0FBQyxTQUFBLEVBQVMsRUFBRSxTQUFBLEVBQVMsQ0FBQyxZQUFhLENBQUEsRUFBQSxVQUFnQixDQUFBO0FBQy9FLFlBQWtCLENBQUE7O1VBRUYsQ0FBQSxFQUFBO1VBQ04sb0JBQUEsUUFBTyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxrQkFBQSxFQUFrQixDQUFDLFFBQUEsRUFBUSxDQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFDLENBQUMsSUFBQSxFQUFJLENBQUMsUUFBUyxDQUFBLEVBQUEsY0FBcUIsQ0FBQTtRQUNoRyxDQUFBO01BQ04sQ0FBQTtLQUNSO0dBQ0Y7QUFDSCxDQUFDLENBQUMsQ0FBQzs7QUFFSCxpREFBaUQseUJBQUE7RUFDL0MsTUFBTSxFQUFFLFdBQVcsQ0FBQztBQUN0QixJQUFJLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDOztJQUU3QixJQUFJLGFBQWEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxTQUFTLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQztNQUMvRCxTQUFTLG9CQUFBLElBQUcsRUFBQSxDQUFBLENBQUMsR0FBQSxFQUFHLENBQUUsS0FBTyxDQUFBLEVBQUMsT0FBYSxDQUFBLEdBQUc7QUFDaEQsS0FBSyxDQUFDLENBQUM7O0lBRUgsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNyQyxJQUFJLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7O0FBRXJDLElBQUksSUFBSSxXQUFXLEdBQUcsTUFBTSxHQUFHLENBQUMsb0JBQUEsSUFBRyxFQUFBLENBQUEsQ0FBQyxHQUFBLEVBQUcsQ0FBQyxHQUFJLENBQUEsRUFBQSxRQUFXLENBQUEsRUFBRSxvQkFBQSxJQUFHLEVBQUEsQ0FBQSxDQUFDLEdBQUEsRUFBRyxDQUFDLEdBQUksQ0FBQSxFQUFDLE1BQVksQ0FBQSxDQUFDLEdBQUcsSUFBSSxDQUFDOztJQUV2RjtNQUNFLG9CQUFBLElBQUcsRUFBQSxJQUFDLEVBQUE7UUFDRixvQkFBQSxJQUFHLEVBQUEsSUFBQyxFQUFBLE1BQVMsQ0FBQSxFQUFBLG9CQUFBLElBQUcsRUFBQSxJQUFDLEVBQUMsS0FBSyxDQUFDLElBQVUsQ0FBQSxFQUFBO1FBQ2xDLG9CQUFBLElBQUcsRUFBQSxJQUFDLEVBQUEsT0FBVSxDQUFBLEVBQUEsb0JBQUEsSUFBRyxFQUFBLElBQUMsRUFBQyxLQUFLLENBQUMsS0FBVyxDQUFBLEVBQUE7UUFDcEMsb0JBQUEsSUFBRyxFQUFBLElBQUMsRUFBQSxPQUFVLENBQUEsRUFBQSxvQkFBQSxJQUFHLEVBQUEsSUFBQyxFQUFDLEtBQUssQ0FBQyxLQUFXLENBQUEsRUFBQTtRQUNwQyxvQkFBQSxJQUFHLEVBQUEsSUFBQyxFQUFBLFVBQWEsQ0FBQSxFQUFBLG9CQUFBLElBQUcsRUFBQSxJQUFDLEVBQUEsb0JBQUEsSUFBRyxFQUFBLElBQUMsRUFBQyxhQUFtQixDQUFLLENBQUEsRUFBQTtRQUNsRCxvQkFBQSxJQUFHLEVBQUEsSUFBQyxFQUFBLFFBQVcsQ0FBQSxFQUFBLG9CQUFBLElBQUcsRUFBQSxJQUFDLEVBQUMsTUFBWSxDQUFBLEVBQUE7UUFDL0IsV0FBVyxFQUFDO1FBQ2Isb0JBQUEsSUFBRyxFQUFBLElBQUMsRUFBQSxTQUFZLENBQUEsRUFBQSxvQkFBQSxJQUFHLEVBQUEsSUFBQyxFQUFBLE1BQVMsQ0FBQTtNQUMxQixDQUFBO0tBQ047R0FDRjtDQUNGLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFRPRE86IEFkZCBtYWlsaW5nIGxpc3Qgb3B0aW9uc1xuLy8gaHR0cHM6Ly9hcGlkb2NzLm1haWxjaGltcC5jb20vYXBpLzIuMC9saXN0cy9zdWJzY3JpYmUucGhwXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE5NjcxNjc2L2phdmFzY3JpcHQtbWFpbGNoaW1wLWFwaS1zdWJzY3JpYmVcblxuUGVyY29sYXRlID0gdHlwZW9mIFBlcmNvbGF0ZSA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IFBlcmNvbGF0ZTtcblBlcmNvbGF0ZS5Db250YWN0ID0ge307XG5cblBlcmNvbGF0ZS5Db250YWN0Lk92ZXJsYXkgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIHByb3BUeXBlczoge1xuICAgIG9wZW46IFJlYWN0LlByb3BUeXBlcy5ib29sXG4gIH0sXG4gIFxuICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBvcGVuOiBmYWxzZVxuICAgIH1cbiAgfSxcbiAgXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9wZW46IHRoaXMucHJvcHMub3BlblxuICAgIH1cbiAgfSxcbiAgXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uKG5leHRQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMub3BlbilcbiAgICAgIHRoaXMuc2V0T3BlbihuZXh0UHJvcHMub3Blbik7XG4gIH0sXG4gIFxuICBzZXRPcGVuOiBmdW5jdGlvbihvcGVuKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7b3BlbjogISEgb3Blbn0pO1xuICB9LFxuICBcbiAgaGFuZGxlQ2xvc2U6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLnNldE9wZW4oZmFsc2UpO1xuICB9LFxuICBcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2xhc3NlcyA9IFJlYWN0LmFkZG9ucy5jbGFzc1NldCh7XG4gICAgICAnbGF5b3V0JzogdHJ1ZSxcbiAgICAgICdjb250YWN0LW9wZW4nOiB0aGlzLnN0YXRlLm9wZW5cbiAgICB9KTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlc30+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3ZlcmxheS1zY3JlZW4tY29udGFjdFwiPlxuICAgICAgICAgIDxhIGNsYXNzTmFtZT1cIm92ZXJsYXktY2xvc2VcIiBvbkNsaWNrPXt0aGlzLmhhbmRsZUNsb3NlfT5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImljb24tY3Jvc3NcIj48L3NwYW4+XG4gICAgICAgICAgPC9hPlxuICAgICAgICAgIDxQZXJjb2xhdGUuQ29udGFjdC5Gb3JtIHNldE92ZXJsYXlPcGVuPXt0aGlzLnNldE9wZW59IC8+XG4gICAgICAgICAgPFBlcmNvbGF0ZS5Db250YWN0LkZvb3RlciAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIClcbiAgfVxufSk7XG5cblBlcmNvbGF0ZS5Db250YWN0LkZvb3RlciA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmNpbGxhcnktY29udGFjdCB2Y2FyZFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndyYXBwZXItY29ubmVjdFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGl0bGUtYW5jaWxsYXJ5XCI+Q29ubmVjdDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGlzdFwiPlxuICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwidXJsIG1vbm9jaHJvbWVcIiBocmVmPVwiaHR0cDovL3R3aXR0ZXIuY29tL3BlcmNvbGF0ZXN0dWRpb1wiIHRhcmdldD1cIl9ibGFua1wiPlR3aXR0ZXI8L2E+XG4gICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJ1cmwgbW9ub2Nocm9tZVwiIGhyZWY9XCJodHRwOi8vZ2l0aHViLmNvbS9wZXJjb2xhdGVzdHVkaW9cIiB0YXJnZXQ9XCJfYmxhbmtcIj5HaXRodWI8L2E+XG4gICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJlbWFpbCBtb25vY2hyb21lXCIgaHJlZj1cIm1haWx0bzp1c0BwZXJjb2xhdGVzdHVkaW8uY29tP3N1YmplY3Q9SGVsbG8lMjBQZXJjb2xhdGVcIj5FbWFpbDwvYT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid3JhcHBlci12aXNpdFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGl0bGUtYW5jaWxsYXJ5XCI+VmlzaXQgVXM8L2Rpdj5cbiAgICAgICAgICA8YSBjbGFzc05hbWU9XCJsb2NhdGlvbi13cmFwcGVyIG9yZ2FuaXphdGlvbi11bml0IGFkclwiXG4gICAgICAgICAgICBocmVmPVwiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYXBzL3BsYWNlLzE2OSsxMXRoK1N0LCtTYW4rRnJhbmNpc2NvLCtDQSs5NDEwMy9AMzcuNzczNTcsLTEyMi40MTU3ODcsMTd6L2RhdGE9ITNtMSE0YjEhNG0yITNtMSExczB4ODA4NTgwOWQ4M2NlZDE4NToweGY1ZTlhZDIzZDVjZDVjZTVcIiB0YXJnZXQ9XCJfYmxhbmtcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZuIG9yZ2FuaXphdGlvbi1uYW1lXCIgc3R5bGU9eyB7ZGlzcGxheTogJ25vbmUnfSB9PlBlcmNvbGF0ZSBTdHVkaW88L3NwYW4+XG4gICAgICAgICAgICA8c3Bhbj5QZXJjb2xhdGUgVVNBPC9zcGFuPjxici8+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJzdHJlZXQtYWRkcmVzc1wiPjE2OSAxMXRoIFN0cmVldDwvc3Bhbj48YnIvPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibG9jYWxpdHlcIj5TYW4gRnJhbmNpc2NvPC9zcGFuPiwgPHNwYW4gY2xhc3NOYW1lPVwicmVnaW9uXCI+Q0E8L3NwYW4+IDxzcGFuIGNsYXNzTmFtZT1cInBvc3RhbC1jb2RlXCI+OTQxMDM8L3NwYW4+XG4gICAgICAgICAgPC9hPlxuICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImxvY2F0aW9uLXdyYXBwZXIgb3JnYW5pemF0aW9uLXVuaXQgYWRyXCJcbiAgICAgICAgICAgIGhyZWY9XCJodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvcGxhY2UvNTArSGVyYmVydCtTdCwrTm9ydGhjb3RlK1ZJQyszMDcwLCtBdXN0cmFsaWEvQC0zNy43NzE3NjQsMTQ0Ljk5NTE2NSwxN3ovZGF0YT0hM20xITRiMSE0bTIhM20xITFzMHg2YWQ2NDM3Y2E0MjBmMTNmOjB4YjY5MDhhZGE1Y2RmYTM3OVwiICB0YXJnZXQ9XCJfYmxhbmtcIj5cbiAgICAgICAgICAgIDxzcGFuPlBlcmNvbGF0ZSBBVVM8L3NwYW4+PGJyLz5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInN0cmVldC1hZGRyZXNzXCI+NTAgSGVyYmVydCBTdHJlZXQ8L3NwYW4+PGJyLz5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImxvY2FsaXR5XCI+TWVsYm91cm5lPC9zcGFuPiwgPHNwYW4gY2xhc3NOYW1lPVwicmVnaW9uXCI+VklDPC9zcGFuPiA8c3BhbiBjbGFzc05hbWU9XCJwb3N0YWwtY29kZVwiPjMwMDE8L3NwYW4+XG4gICAgICAgICAgPC9hPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIClcbiAgfVxufSk7XG5cbi8vIEdhdGhlcnMgYWxsIHRydXRoeSB2YWx1ZXMgaW4gb2JqIHJlZmVyZW5jZWQgYnkga2V5cyBhbmQgcmV0dXJucyBtYXRjaGluZ1xuLy8ga2V5cyBpbiBhbiBhcnJheVxudmFyIGdhdGhlclRydXRoeSA9IGZ1bmN0aW9uKC8qIG9iaiwgLi4ua2V5cyAqLykge1xuICB2YXIga2V5cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgXG4gIG9iaiA9IGtleXMuc2hpZnQoKTtcbiAgXG4gIF8uZWFjaChrZXlzLCBmdW5jdGlvbihrZXkpIHtcbiAgICBpZiAob2JqW2tleV0gJiYgcmVzdWx0LmluZGV4T2Yoa2V5KSA9PT0gLTEpXG4gICAgICByZXN1bHQucHVzaChrZXkpO1xuICB9KTtcbiAgXG4gIHJldHVybiByZXN1bHQ7XG59XG5cblBlcmNvbGF0ZS5Db250YWN0LkZvcm0gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIG1peGluczogW1JlYWN0LmFkZG9ucy5MaW5rZWRTdGF0ZU1peGluXSxcbiAgXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgZW1haWw6ICcnLFxuICAgICAgYWJvdXQ6ICcnLFxuICAgICAgc3RyYXRlZ3k6IGZhbHNlLFxuICAgICAgZGVzaWduOiBmYWxzZSxcbiAgICAgIGVuZ2luZWVyaW5nOiBmYWxzZSxcbiAgICAgIGNvbnN1bHRpbmc6IGZhbHNlLFxuICAgICAgdG9kYXk6IGZhbHNlLFxuICAgICAgcXVhcnRlcjogZmFsc2UsXG4gICAgICB5ZWFyOiBmYWxzZSxcbiAgICAgICcyNWsnOiBmYWxzZSxcbiAgICAgICc1MGsnOiBmYWxzZSxcbiAgICAgICcxMDBrJzogZmFsc2UsXG4gICAgICBub3RzdXJlOiBmYWxzZSxcbiAgICAgIGVycm9yczoge30sXG4gICAgICBzdWJtaXR0aW5nOiBmYWxzZVxuICAgIH07XG4gIH0sXG4gIFxuICBnZXRNb2RlbDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1vZGVsID0gXy5waWNrKHRoaXMuc3RhdGUsICduYW1lJywgJ2VtYWlsJywgJ2Fib3V0Jyk7XG4gICAgbW9kZWwuc2VydmljZXMgPSBnYXRoZXJUcnV0aHkodGhpcy5zdGF0ZSwgJ3N0cmF0ZWd5JywgJ2Rlc2lnbicsIFxuICAgICAgJ2VuZ2luZWVyaW5nJywgJ2NvbnN1bHRpbmcnKTtcbiAgICBtb2RlbC50aW1pbmcgPSBnYXRoZXJUcnV0aHkodGhpcy5zdGF0ZSwgJ3RvZGF5JywgJ3F1YXJ0ZXInLCAneWVhcicpO1xuICAgIG1vZGVsLmJ1ZGdldCA9IGdhdGhlclRydXRoeSh0aGlzLnN0YXRlLCAnMjVrJywgJzUwaycsICcxMDBrJywgJ25vdHN1cmUnKTtcblxuICAgIHJldHVybiBtb2RlbDtcbiAgfSxcbiAgICBcbiAgaGFuZGxlU3VibWl0OiBmdW5jdGlvbihldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgXG4gICAgaWYgKHRoaXMudmFsaWRhdGUoKSkge1xuICAgICAgdGhpcy5zZW5kKCk7XG4gICAgfVxuICB9LFxuICBcbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIGpRdWVyeSh0aGlzLnJlZnMuYWJvdXQuZ2V0RE9NTm9kZSgpKS5hdXRvc2l6ZSgpO1xuICB9LFxuICBcbiAgYWxlcnRDbGFzczogZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLmVycm9yc1tuYW1lXSA/ICdhbGVydCcgOiAnJztcbiAgfSxcbiAgXG4gIC8vIHVyZ2gsIHdpc2ggd2UgaGFkIGEgc2NoZW1hIGxpYnJhcnlcbiAgdmFsaWRhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBlcnJvcnMgPSB0aGlzLnN0YXRlLmVycm9ycyA9IHt9LCBcbiAgICAgIHZhbGlkID0gdHJ1ZSxcbiAgICAgIG1vZGVsID0gdGhpcy5nZXRNb2RlbCgpO1xuICAgIFxuICAgIF8uZWFjaChbJ25hbWUnLCAnZW1haWwnLCAnYWJvdXQnXSwgZnVuY3Rpb24oZmllbGQpIHtcbiAgICAgIGlmICghIG1vZGVsW2ZpZWxkXSkge1xuICAgICAgICBlcnJvcnNbZmllbGRdID0gJ2lzIHJlcXVpcmVkJztcbiAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZiAobW9kZWxbZmllbGRdLmxlbmd0aCA+IDEwMDAwKSB7XG4gICAgICAgIGVycm9yc1tmaWVsZF0gPSAnaXMgdG9vIGxvbmcnO1xuICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gICAgXG4gICAgXy5lYWNoKFsnc2VydmljZXMnLCAndGltaW5nJ10sIGZ1bmN0aW9uKGZpZWxkKSB7XG4gICAgICBpZiAoISBtb2RlbFtmaWVsZF0ubGVuZ3RoKSB7XG4gICAgICAgIGVycm9yc1tmaWVsZF0gPSAnaXMgcmVxdWlyZWQnO1xuICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICBpZiAodGhpcy5zaG91bGRIYXZlQnVkZ2V0KCkgJiYgISBtb2RlbC5idWRnZXQubGVuZ3RoKSB7XG4gICAgICBlcnJvcnNbJ2J1ZGdldCddID0gJ2lzIHJlcXVpcmVkJztcbiAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgfVxuICAgIFxuICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yczogZXJyb3JzfSk7XG5cbiAgICByZXR1cm4gdmFsaWQ7XG4gIH0sXG4gIFxuICBzZW5kOiBmdW5jdGlvbihtb2RlbCkge1xuICAgIHZhciBtb2RlbCA9IHRoaXMuZ2V0TW9kZWwoKTtcbiAgICB2YXIgdG8gPSAndXNAcGVyY29sYXRlc3R1ZGlvLmNvbSc7XG4gICAgdmFyIHN1YmplY3QgPSAnV29yayB3aXRoIHVzJztcbiAgICB2YXIgYm9keSA9IFJlYWN0LnJlbmRlclRvU3RhdGljTWFya3VwKFxuICAgICAgPFBlcmNvbGF0ZS5Db250YWN0LkZvcm1FbWFpbCBtb2RlbD17bW9kZWx9Lz4pO1xuICBcbiAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgJ2tleSc6ICctSnFsYktiMlpIVTdSNU5Fa0N2bkt3JywgLy8gY2hhbmdlbWVcbiAgICAgICAgJ21lc3NhZ2UnOiB7XG4gICAgICAgICAgJ2Zyb21fZW1haWwnOiBtb2RlbC5lbWFpbCxcbiAgICAgICAgICAndG8nOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAnZW1haWwnOiB0byxcbiAgICAgICAgICAgICAgICAnbmFtZSc6ICdQZXJjb2xhdGUgU3R1ZGlvJyxcbiAgICAgICAgICAgICAgICAndHlwZSc6ICd0bydcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICdlbWFpbCc6ICd6b2xAcGVyY29sYXRlc3R1ZGlvLmNvbScsIC8vIGp1c3QgaW4gY2FzZSB1c0AgYnJlYWtzXG4gICAgICAgICAgICAgICAgJ25hbWUnOiAnWm9sdGFuIE9sYWgnLFxuICAgICAgICAgICAgICAgICd0eXBlJzogJ3RvJ1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICdhdXRvdGV4dCc6ICd0cnVlJyxcbiAgICAgICAgICAnc3ViamVjdCc6IHN1YmplY3QsXG4gICAgICAgICAgJ2h0bWwnOiBib2R5XG4gICAgICAgIH1cbiAgICAgIH07XG4gIFxuICAgIHRoaXMuc2V0U3RhdGUoeyBzdWJtaXR0aW5nOiB0cnVlIH0pO1xuICAgIGpRdWVyeS5wb3N0KCdodHRwczovL21hbmRyaWxsYXBwLmNvbS9hcGkvMS4wL21lc3NhZ2VzL3NlbmQuanNvbicsIGRhdGEpXG4gICAgICAuZG9uZShmdW5jdGlvbigpIHtcbiAgICAgICAgYWxlcnQoJ1RoYW5rIHlvdS4gV2Ugd2lsbCBjb250YWN0IHlvdSBzaG9ydGx5Jyk7XG4gICAgICB9KVxuICAgICAgLmZhaWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGZhbGxiYWNrIGluY2FzZSBhamF4IGZhaWxzXG4gICAgICAgIHdpbmRvdy5vcGVuKCdtYWlsdG86JyArIHRvIFxuICAgICAgICAgICsgJz9zdWJqZWN0PScgKyBzdWJqZWN0ICsgJyAobWFpbHRvKSdcbiAgICAgICAgICArICcmYm9keT0nICsgZXNjYXBlKGJvZHkpXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICAgLmFsd2F5cyhmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHN1Ym1pdHRpbmc6IGZhbHNlIH0pO1xuICAgICAgICB0aGlzLnByb3BzLnNldE92ZXJsYXlPcGVuKGZhbHNlKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG4gIFxuICBlcnJvcjogZnVuY3Rpb24obmFtZSkge1xuICAgIGlmICh0aGlzLnN0YXRlLmVycm9yc1tuYW1lXSlcbiAgICAgIHJldHVybiAoPHNwYW4gY2xhc3NOYW1lPVwiZXJyb3JcIj57dGhpcy5zdGF0ZS5lcnJvcnNbbmFtZV19PC9zcGFuPik7XG4gIH0sXG4gIFxuICBzaG91bGRIYXZlQnVkZ2V0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5zdHJhdGVneSB8fCB0aGlzLnN0YXRlLmRlc2lnbiB8fCB0aGlzLnN0YXRlLmVuZ2luZWVyaW5nO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGJ1ZGdldEZpZWxkc2V0Q2xhc3NlcyA9IFwiZmllbGRzZXQtZ3JvdXAgXCJcbiAgICAgICsgKHRoaXMuc2hvdWxkSGF2ZUJ1ZGdldCgpID8gJ3Zpc2libGUnIDogJ2hpZGRlbicpO1xuICAgIFxuICAgIHZhciBzZXJ2aWNlc0Vycm9yID0gdGhpcy5lcnJvcignc2VydmljZXMnKTtcblxuICAgIHZhciBzZXJ2aWNlc0xhYmVsID0gc2VydmljZXNFcnJvciA/IHNlcnZpY2VzRXJyb3IgOlxuICAgICAgKDxzcGFuIGNsYXNzTmFtZT1cInN1YnRleHRcIj5TZWxlY3QgYWxsIHRoYXQgYXBwbHk8L3NwYW4+KTtcblxuICAgIHJldHVybiAoXG4gICAgICA8Zm9ybSBjbGFzc05hbWU9XCJjb250YWN0LWZvcm0td3JhcHBlclwiIG9uU3VibWl0PXt0aGlzLmhhbmRsZVN1Ym1pdH0+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGl0bGUtb3ZlcmxheVwiPldvcmsgd2l0aCB1czwvZGl2PlxuICAgICAgICA8ZmllbGRzZXQ+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1zeW1ib2wgbGVmdFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cIm5hbWVcIiBjbGFzc05hbWU9e3RoaXMuYWxlcnRDbGFzcygnbmFtZScpfSBwbGFjZWhvbGRlcj1cIk5hbWVcIiB2YWx1ZUxpbms9e3RoaXMubGlua1N0YXRlKCduYW1lJyl9IC8+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJpY29uLXVzZXJcIj48L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1zeW1ib2wgbGVmdFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJlbWFpbFwiIG5hbWU9XCJlbWFpbFwiIGNsYXNzTmFtZT17dGhpcy5hbGVydENsYXNzKCdlbWFpbCcpfSBwbGFjZWhvbGRlcj1cIkVtYWlsIEFkZHJlc3NcIiB2YWx1ZUxpbms9e3RoaXMubGlua1N0YXRlKCdlbWFpbCcpfSAvPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaWNvbi1lbWFpbFwiPjwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8dGV4dGFyZWEgY2xhc3NOYW1lPXsnYWJvdXQgJyArIHRoaXMuYWxlcnRDbGFzcygnYWJvdXQnKX0gbmFtZT1cImFib3V0XCIgcGxhY2Vob2xkZXI9XCJBYm91dCB5b3VyIGNvbXBhbnkgYW5kIHByb2plY3RcIiB2YWx1ZUxpbms9e3RoaXMubGlua1N0YXRlKCdhYm91dCcpfSByZWY9XCJhYm91dFwiIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaWVsZHNldC1ncm91cCBzZXJ2aWNlc1wiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaWVsZHNldC1ncm91cC10aXRsZVwiPlNlcnZpY2VzIHtzZXJ2aWNlc0xhYmVsfTwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bnMtZ3JvdXBcIj5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5hbWU9XCJzZXJ2aWNlc1wiIHZhbHVlPVwic3RyYXRlZ3lcIiBpZD1cInN0cmF0ZWd5XCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCdzdHJhdGVneScpfSAvPlxuICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj1cInN0cmF0ZWd5XCIgY2xhc3NOYW1lPVwiYnRuLXRvZ2dsZVwiPlN0cmF0ZWd5PC9sYWJlbD5cblxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cInNlcnZpY2VzXCIgdmFsdWU9XCJkZXNpZ25cIiBpZD1cImRlc2lnblwiIGNoZWNrZWRMaW5rPXt0aGlzLmxpbmtTdGF0ZSgnZGVzaWduJyl9IC8+XG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiZGVzaWduXCIgY2xhc3NOYW1lPVwiYnRuLXRvZ2dsZVwiPkRlc2lnbjwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5hbWU9XCJzZXJ2aWNlc1wiIHZhbHVlPVwiZW5naW5lZXJpbmdcIiBpZD1cImVuZ2luZWVyaW5nXCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCdlbmdpbmVlcmluZycpfSAvPlxuICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj1cImVuZ2luZWVyaW5nXCIgY2xhc3NOYW1lPVwiYnRuLXRvZ2dsZVwiPkVuZ2luZWVyaW5nPC9sYWJlbD5cblxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cInNlcnZpY2VzXCIgdmFsdWU9XCJjb25zdWx0aW5nXCIgaWQ9XCJjb25zdWx0aW5nXCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCdjb25zdWx0aW5nJyl9IC8+XG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiY29uc3VsdGluZ1wiIGNsYXNzTmFtZT1cImJ0bi10b2dnbGVcIj5Db25zdWx0aW5nPC9sYWJlbD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmllbGRzZXQtZ3JvdXBcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmllbGRzZXQtZ3JvdXAtdGl0bGVcIj5UaW1pbmcge3RoaXMuZXJyb3IoJ3RpbWluZycpfTwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bnMtZ3JvdXBcIj5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJ0aW1pbmdcIiB2YWx1ZT1cInRvZGF5XCIgaWQ9XCJ0b2RheVwiIGNoZWNrZWRMaW5rPXt0aGlzLmxpbmtTdGF0ZSgndG9kYXknKX0gLz5cbiAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0b2RheVwiIGNsYXNzTmFtZT1cImJ0bi10b2dnbGVcIj5Ub2RheTwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJ0aW1pbmdcIiB2YWx1ZT1cInF1YXJ0ZXJcIiBpZD1cInF1YXJ0ZXJcIiBjaGVja2VkTGluaz17dGhpcy5saW5rU3RhdGUoJ3F1YXJ0ZXInKX0gLz5cbiAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJxdWFydGVyXCIgY2xhc3NOYW1lPVwiYnRuLXRvZ2dsZVwiPlF1YXJ0ZXI8L2xhYmVsPlxuXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwidGltaW5nXCIgdmFsdWU9XCJ5ZWFyXCIgaWQ9XCJ5ZWFyXCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCd5ZWFyJyl9IC8+XG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwieWVhclwiIGNsYXNzTmFtZT1cImJ0bi10b2dnbGVcIj5UaGlzIFllYXI8L2xhYmVsPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2J1ZGdldEZpZWxkc2V0Q2xhc3Nlc30+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpZWxkc2V0LWdyb3VwLXRpdGxlXCI+QnVkZ2V0IHt0aGlzLmVycm9yKCdidWRnZXQnKX08L2Rpdj5cblxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5zLWdyb3VwXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiYnVkZ2V0XCIgdmFsdWU9XCIyNWtcIiBpZD1cIjI1a1wiIGNoZWNrZWRMaW5rPXt0aGlzLmxpbmtTdGF0ZSgnMjVrJyl9IC8+XG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiMjVrXCIgY2xhc3NOYW1lPVwiYnRuLXRvZ2dsZVwiPjI1a+KAkzUwazwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJidWRnZXRcIiB2YWx1ZT1cIjUwa1wiIGlkPVwiNTBrXCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCc1MGsnKX0gLz5cbiAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCI1MGtcIiAgY2xhc3NOYW1lPVwiYnRuLXRvZ2dsZVwiPjUwa+KAkzEwMGs8L2xhYmVsPlxuXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiYnVkZ2V0XCIgdmFsdWU9XCIxMDBrXCIgaWQ9XCIxMDBrXCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCcxMDBrJyl9IC8+XG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiMTAwa1wiIGNsYXNzTmFtZT1cImJ0bi10b2dnbGVcIiA+KzEwMGs8L2xhYmVsPlxuXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiYnVkZ2V0XCIgdmFsdWU9XCJub3RzdXJlXCIgaWQ9XCJub3RzdXJlXCIgY2hlY2tlZExpbms9e3RoaXMubGlua1N0YXRlKCdub3RzdXJlJyl9IC8+XG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwibm90c3VyZVwiICBjbGFzc05hbWU9XCJidG4tdG9nZ2xlXCI+Tm90IHN1cmU8L2xhYmVsPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0bi1wcmltYXJ5IGNhcHNcIiBkaXNhYmxlZD17dGhpcy5zdGF0ZS5zdWJtaXR0aW5nfSB0eXBlPVwic3VibWl0XCI+U2VuZCBNZXNzYWdlPC9idXR0b24+XG4gICAgICAgIDwvZmllbGRzZXQ+XG4gICAgICA8L2Zvcm0+XG4gICAgKVxuICB9XG59KTtcblxuUGVyY29sYXRlLkNvbnRhY3QuRm9ybUVtYWlsID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtb2RlbCA9IHRoaXMucHJvcHMubW9kZWw7XG4gICAgXG4gICAgdmFyIHNlcnZpY2VzTm9kZXMgPSBtb2RlbC5zZXJ2aWNlcy5tYXAoZnVuY3Rpb24oc2VydmljZSwgaW5kZXgpIHtcbiAgICAgIHJldHVybiAoIDxsaSBrZXk9e2luZGV4fT57c2VydmljZX08L2xpPiApO1xuICAgIH0pO1xuICAgIFxuICAgIHZhciB0aW1pbmcgPSBtb2RlbC50aW1pbmcuam9pbigpO1xuICAgIHZhciBidWRnZXQgPSBtb2RlbC5idWRnZXQuam9pbigpO1xuICAgIFxuICAgIHZhciBidWRnZXROb2RlcyA9IGJ1ZGdldCA/IFs8ZHQga2V5PScwJz5CdWRnZXQ8L2R0PiwgPGRkIGtleT0nMSc+e2J1ZGdldH08L2RkPl0gOiBudWxsO1xuICAgIFxuICAgIHJldHVybiAoXG4gICAgICA8ZGw+XG4gICAgICAgIDxkdD5OYW1lPC9kdD48ZGQ+e21vZGVsLm5hbWV9PC9kZD5cbiAgICAgICAgPGR0PkVtYWlsPC9kdD48ZGQ+e21vZGVsLmVtYWlsfTwvZGQ+XG4gICAgICAgIDxkdD5BYm91dDwvZHQ+PGRkPnttb2RlbC5hYm91dH08L2RkPlxuICAgICAgICA8ZHQ+U2VydmljZXM8L2R0PjxkZD48dWw+e3NlcnZpY2VzTm9kZXN9PC91bD48L2RkPlxuICAgICAgICA8ZHQ+VGltaW5nPC9kdD48ZGQ+e3RpbWluZ308L2RkPlxuICAgICAgICB7YnVkZ2V0Tm9kZXN9XG4gICAgICAgIDxkdD5SZWZlcmVyPC9kdD48ZGQ+QmxvZzwvZGQ+XG4gICAgICA8L2RsPlxuICAgIClcbiAgfVxufSk7XG4iXX0=